module.exports=function(){function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,t,n,r,i,u){this.message=e,this.expected=t,this.found=n,this.offset=r,this.line=i,this.column=u,this.name="SyntaxError"}function n(e){function n(t){function n(t,n,r){var i,u;for(i=n;r>i;i++)u=e.charAt(i),"\n"===u?(t.seenCR||t.line++,t.column=1,t.seenCR=!1):"\r"===u||"\u2028"===u||"\u2029"===u?(t.line++,t.column=1,t.seenCR=!0):(t.column++,t.seenCR=!1)}return Mt!==t&&(Mt>t&&(Mt=0,Nt={line:1,column:1,seenCR:!1}),n(Nt,Mt,t),Mt=t),Nt}function r(e){Ot>Kt||(Kt>Ot&&(Ot=Kt,Pt=[]),Pt.push(e))}function i(r,i,u){function o(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}function c(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r,i,u,o=new Array(e.length);for(u=0;u<e.length;u++)o[u]=e[u].description;return r=e.length>1?o.slice(0,-1).join(", ")+" or "+o[e.length-1]:o[0],i=t?'"'+n(t)+'"':"end of input","Expected "+r+" but "+i+" found."}var a=n(u),l=u<e.length?e.charAt(u):null;return null!==i&&o(i),new t(null!==r?r:c(i,l),i,l,u,a.line,a.column)}function u(){var e;return e=m()}function o(){var t,n,i;for(t=Kt,n=[],U.test(e.charAt(Kt))?(i=e.charAt(Kt),Kt++):(i=_,0===Qt&&r(D));i!==_;)n.push(i),U.test(e.charAt(Kt))?(i=e.charAt(Kt),Kt++):(i=_,0===Qt&&r(D));return n!==_&&(Lt=t,n=G(n)),t=n}function c(){var t,n,i,u,c;return t=Kt,n=o(),n!==_?(i=Kt,u=Kt,Qt++,92===e.charCodeAt(Kt)?(c=J,Kt++):(c=_,0===Qt&&r(K)),Qt--,c===_?u=I:(Kt=u,u=H),u!==_?(e.substr(Kt,2)===L?(c=L,Kt+=2):(c=_,0===Qt&&r(M)),c!==_?(u=[u,c],i=u):(Kt=i,i=H)):(Kt=i,i=H),i!==_?(n=[n,i],t=n):(Kt=t,t=H)):(Kt=t,t=H),t}function a(){var t,n,i;return t=Kt,n=Kt,Qt++,92===e.charCodeAt(Kt)?(i=J,Kt++):(i=_,0===Qt&&r(K)),Qt--,i===_?n=I:(Kt=n,n=H),n!==_?(e.substr(Kt,2)===N?(i=N,Kt+=2):(i=_,0===Qt&&r(O)),i!==_?(n=[n,i],t=n):(Kt=t,t=H)):(Kt=t,t=H),t}function l(){var t,n,i;return t=c(),t===_&&(t=Kt,Q.test(e.charAt(Kt))?(n=e.charAt(Kt),Kt++):(n=_,0===Qt&&r(T)),n===_&&(n=P),n!==_?(i=a(),i!==_?(n=[n,i],t=n):(Kt=t,t=H)):(Kt=t,t=H)),t}function f(){var t,n,i;return t=Kt,n=Kt,Qt++,i=l(),Qt--,i===_?n=I:(Kt=n,n=H),n!==_?(e.length>Kt?(i=e.charAt(Kt),Kt++):(i=_,0===Qt&&r(V)),i!==_?(Lt=t,n=W(i),t=n):(Kt=t,t=H)):(Kt=t,t=H),t}function s(){var t,n,i,u,c;return t=Kt,n=o(),n!==_?(i=Kt,u=Kt,Qt++,92===e.charCodeAt(Kt)?(c=J,Kt++):(c=_,0===Qt&&r(K)),Qt--,c===_?u=I:(Kt=u,u=H),u!==_?(40===e.charCodeAt(Kt)?(c=X,Kt++):(c=_,0===Qt&&r(Y)),c!==_?(u=[u,c],i=u):(Kt=i,i=H)):(Kt=i,i=H),i!==_?(Lt=t,n=$(),t=n):(Kt=t,t=H)):(Kt=t,t=H),t}function p(){var t,n,i,u,c;return t=Kt,n=o(),n!==_?(i=Kt,u=Kt,Qt++,92===e.charCodeAt(Kt)?(c=J,Kt++):(c=_,0===Qt&&r(K)),Qt--,c===_?u=I:(Kt=u,u=H),u!==_?(41===e.charCodeAt(Kt)?(c=et,Kt++):(c=_,0===Qt&&r(tt)),c!==_?(u=[u,c],i=u):(Kt=i,i=H)):(Kt=i,i=H),i!==_?(Lt=t,n=nt(),t=n):(Kt=t,t=H)):(Kt=t,t=H),t}function h(){var t,n,i,u;return t=Kt,n=Kt,i=Kt,Qt++,u=s(),u===_&&(u=p()),Qt--,u===_?i=I:(Kt=i,i=H),i!==_?(e.length>Kt?(u=e.charAt(Kt),Kt++):(u=_,0===Qt&&r(V)),u!==_?(i=[i,u],n=i):(Kt=n,n=H)):(Kt=n,n=H),n!==_&&(Lt=t,n=rt(n)),t=n}function d(){var e,t,n;if(e=Kt,t=[],n=f(),n!==_)for(;n!==_;)t.push(n),n=f();else t=H;return t!==_&&(Lt=e,t=it(t)),e=t}function v(){var e,t,n;return e=Kt,t=d(),t!==_?(Lt=Kt,n=ut(t),n=n?I:H,n!==_?(Lt=e,t=ot(t),e=t):(Kt=e,e=H)):(Kt=e,e=H),e}function A(){var e,t;return e=Kt,t=v(),t!==_&&(Lt=e,t=ct(t)),e=t}function C(){var t,n,i,u,c,a,f,s;if(t=Kt,n=o(),n!==_){if(i=Kt,40===e.charCodeAt(Kt)?(u=X,Kt++):(u=_,0===Qt&&r(Y)),u!==_){for(c=[],a=Kt,f=Kt,Qt++,s=l(),Qt--,s===_?f=I:(Kt=f,f=H),f!==_?(s=C(),s===_&&(s=h()),s!==_?(Lt=a,f=at(s),a=f):(Kt=a,a=H)):(Kt=a,a=H);a!==_;)c.push(a),a=Kt,f=Kt,Qt++,s=l(),Qt--,s===_?f=I:(Kt=f,f=H),f!==_?(s=C(),s===_&&(s=h()),s!==_?(Lt=a,f=at(s),a=f):(Kt=a,a=H)):(Kt=a,a=H);c!==_?(41===e.charCodeAt(Kt)?(a=et,Kt++):(a=_,0===Qt&&r(tt)),a!==_?(u=[u,c,a],i=u):(Kt=i,i=H)):(Kt=i,i=H)}else Kt=i,i=H;i!==_?(Lt=t,n=lt(c),t=n):(Kt=t,t=H)}else Kt=t,t=H;return t}function g(){var t,n,i,u;if(t=Kt,n=o(),n!==_){if(i=[],ft.test(e.charAt(Kt))?(u=e.charAt(Kt),Kt++):(u=_,0===Qt&&r(st)),u!==_)for(;u!==_;)i.push(u),ft.test(e.charAt(Kt))?(u=e.charAt(Kt),Kt++):(u=_,0===Qt&&r(st));else i=H;i!==_?(Lt=t,n=pt(i),t=n):(Kt=t,t=H)}else Kt=t,t=H;return t}function y(){var t,n,i,u,c,a,l,f;if(t=Kt,40===e.charCodeAt(Kt)?(n=X,Kt++):(n=_,0===Qt&&r(Y)),n!==_)if(i=g(),i===_&&(i=P),i!==_){for(u=[],c=Kt,a=o(),a!==_?(44===e.charCodeAt(Kt)?(l=ht,Kt++):(l=_,0===Qt&&r(dt)),l!==_?(f=g(),f!==_?(a=[a,l,f],c=a):(Kt=c,c=H)):(Kt=c,c=H)):(Kt=c,c=H);c!==_;)u.push(c),c=Kt,a=o(),a!==_?(44===e.charCodeAt(Kt)?(l=ht,Kt++):(l=_,0===Qt&&r(dt)),l!==_?(f=g(),f!==_?(a=[a,l,f],c=a):(Kt=c,c=H)):(Kt=c,c=H)):(Kt=c,c=H);u!==_?(41===e.charCodeAt(Kt)?(c=et,Kt++):(c=_,0===Qt&&r(tt)),c!==_?(Lt=t,n=vt(i,u),t=n):(Kt=t,t=H)):(Kt=t,t=H)}else Kt=t,t=H;else Kt=t,t=H;return t}function m(){var t,n,i,u,l,f,s,p,h,d,v;if(t=Kt,n=c(),n!==_)if(37===e.charCodeAt(Kt)?(i=At,Kt++):(i=_,0===Qt&&r(Ct)),i!==_)if(u=o(),u!==_)if(l=g(),l===_&&(l=P),l!==_)if(f=y(),f!==_){for(s=[],p=z(),p===_&&(p=R());p!==_;)s.push(p),p=z(),p===_&&(p=R());s!==_?(p=o(),p!==_?(37===e.charCodeAt(Kt)?(h=At,Kt++):(h=_,0===Qt&&r(Ct)),h===_&&(h=P),h!==_?(d=a(),d!==_?(v=o(),v!==_?(Lt=t,n=gt(l,f,s),t=n):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)}else Kt=t,t=H;else Kt=t,t=H;else Kt=t,t=H;else Kt=t,t=H;else Kt=t,t=H;return t}function x(){var t,n,i,u,l,f,s,p,h;if(t=Kt,n=c(),n!==_)if(64===e.charCodeAt(Kt)?(i=yt,Kt++):(i=_,0===Qt&&r(mt)),i!==_)if(u=C(),u!==_)if(l=y(),l!==_){for(f=[],s=z();s!==_;)f.push(s),s=z();f!==_?(s=o(),s!==_?(64===e.charCodeAt(Kt)?(p=yt,Kt++):(p=_,0===Qt&&r(mt)),p===_&&(p=P),p!==_?(h=a(),h!==_?(Lt=t,n=xt(u,l,f),t=n):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)}else Kt=t,t=H;else Kt=t,t=H;else Kt=t,t=H;else Kt=t,t=H;return t}function F(){var t,n,i,u,l,f,s,p;return t=Kt,n=c(),n!==_?(43===e.charCodeAt(Kt)?(i=Ft,Kt++):(i=_,0===Qt&&r(jt)),i!==_?(u=g(),u!==_?(l=C(),l!==_?(f=o(),f!==_?(43===e.charCodeAt(Kt)?(s=Ft,Kt++):(s=_,0===Qt&&r(jt)),s===_&&(s=P),s!==_?(p=a(),p!==_?(Lt=t,n=Rt(u,l),t=n):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H),t}function j(){var t,n,i,u,l,f,s,p,h,d;if(t=Kt,n=c(),n!==_)if(62===e.charCodeAt(Kt)?(i=Et,Kt++):(i=_,0===Qt&&r(wt)),i!==_)if(u=g(),u!==_)if(l=o(),l!==_)if(f=C(),f!==_){for(s=[],p=m();p!==_;)s.push(p),p=m();s!==_?(p=o(),p!==_?(60===e.charCodeAt(Kt)?(h=bt,Kt++):(h=_,0===Qt&&r(kt)),h===_&&(h=P),h!==_?(d=a(),d!==_?(Lt=t,n=zt(u,f,s),t=n):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)}else Kt=t,t=H;else Kt=t,t=H;else Kt=t,t=H;else Kt=t,t=H;else Kt=t,t=H;return t}function R(){var t,n,i,u,l,f,s,p;if(t=Kt,n=c(),n!==_)if(60===e.charCodeAt(Kt)?(i=bt,Kt++):(i=_,0===Qt&&r(kt)),i!==_)if(u=g(),u!==_){for(l=[],f=z();f!==_;)l.push(f),f=z();l!==_?(f=o(),f!==_?(62===e.charCodeAt(Kt)?(s=Et,Kt++):(s=_,0===Qt&&r(wt)),s===_&&(s=P),s!==_?(p=a(),p!==_?(Lt=t,n=St(u,l),t=n):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)}else Kt=t,t=H;else Kt=t,t=H;else Kt=t,t=H;return t}function E(){var t,n,i,u,l,f,s,p;if(t=Kt,n=c(),n!==_)if(63===e.charCodeAt(Kt)?(i=Zt,Kt++):(i=_,0===Qt&&r(_t)),i!==_)if(u=C(),u!==_){for(l=[],f=w(),f===_&&(f=z());f!==_;)l.push(f),f=w(),f===_&&(f=z());l!==_?(f=o(),f!==_?(63===e.charCodeAt(Kt)?(s=Zt,Kt++):(s=_,0===Qt&&r(_t)),s===_&&(s=P),s!==_?(p=a(),p!==_?(Lt=t,n=qt(u,l),t=n):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)}else Kt=t,t=H;else Kt=t,t=H;else Kt=t,t=H;return t}function w(){var t,n,i,u,l,f,s,p;if(t=Kt,n=c(),n!==_)if(58===e.charCodeAt(Kt)?(i=Bt,Kt++):(i=_,0===Qt&&r(Ut)),i!==_)if(u=C(),u===_&&(u=P),u!==_){for(l=[],f=z();f!==_;)l.push(f),f=z();l!==_?(f=o(),f!==_?(58===e.charCodeAt(Kt)?(s=Bt,Kt++):(s=_,0===Qt&&r(Ut)),s===_&&(s=P),s!==_?(p=a(),p!==_?(Lt=t,n=Dt(u,l),t=n):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)}else Kt=t,t=H;else Kt=t,t=H;else Kt=t,t=H;return t}function b(){var e,t,n,r;return e=Kt,t=c(),t!==_?(n=v(),n!==_?(r=a(),r!==_?(Lt=e,t=Gt(n),e=t):(Kt=e,e=H)):(Kt=e,e=H)):(Kt=e,e=H),e}function k(){var t,n,i,u,o,l;return t=Kt,n=c(),n!==_?(33===e.charCodeAt(Kt)?(i=Ht,Kt++):(i=_,0===Qt&&r(It)),i!==_?(u=v(),u!==_?(33===e.charCodeAt(Kt)?(o=Ht,Kt++):(o=_,0===Qt&&r(It)),o===_&&(o=P),o!==_?(l=a(),l!==_?(Lt=t,n=Jt(u),t=n):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H)):(Kt=t,t=H),t}function z(){var e;return e=m(),e===_&&(e=x(),e===_&&(e=j(),e===_&&(e=F(),e===_&&(e=E(),e===_&&(e=k(),e===_&&(e=b(),e===_&&(e=A()))))))),e}var S,Z=arguments.length>1?arguments[1]:{},_={},q={start:u},B=u,U=/^[ \n\r\t]/,D={type:"class",value:"[ \\n\\r\\t]",description:"[ \\n\\r\\t]"},G=function(e){e.join("")},H=_,I=void 0,J="\\",K={type:"literal",value:"\\",description:'"\\\\"'},L="{{",M={type:"literal",value:"{{",description:'"{{"'},N="}}",O={type:"literal",value:"}}",description:'"}}"'},P=null,Q=/^[%@<>+?:!]/,T={type:"class",value:"[%@<>+?:!]",description:"[%@<>+?:!]"},V={type:"any",description:"any character"},W=function(e){return e},X="(",Y={type:"literal",value:"(",description:'"("'},$=function(){return"("},et=")",tt={type:"literal",value:")",description:'")"'},nt=function(){return")"},rt=function(e){return e[1]},it=function(e){return e.join("")},ut=function(e){return e.replace(/\s+/,"")},ot=function(e){return e},ct=function(e){return'out += "'+e.replace(/[\r\n]/g,"\\n").replace(/"/g,'\\"')+'";\n'},at=function(e){return e},lt=function(e){return"("+e.join("")+")"},ft=/^[a-zA-Z_]/,st={type:"class",value:"[a-zA-Z_]",description:"[a-zA-Z_]"},pt=function(e){return e.join("")},ht=",",dt={type:"literal",value:",",description:'","'},vt=function(e,t){return"("+(e?[e].concat(t.map(function(e){return e[1]})):[])+")"},At="%",Ct={type:"literal",value:"%",description:'"%"'},gt=function(e,t,n){var r="function "+(e?e:"")+t+'{\n  var out = "";'+(n.length?n.join(""):"")+"  return out;}\n";return r.kataname=e,r},yt="@",mt={type:"literal",value:"@",description:'"@"'},xt=function(e,t,n){return e+".forEach(function"+t+"{\n"+(n.length?n.join(""):"")+"}\n"},Ft="+",jt={type:"literal",value:"+",description:'"+"'},Rt=function(e,t){return"var "+e+" = require("+t+");\n"},Et=">",wt={type:"literal",value:">",description:'">"'},bt="<",kt={type:"literal",value:"<",description:'"<"'},zt=function(e,t,n){"out += "+e+".bind({"+n.reduce(function(e,t){return t.kataname?(e.push(t.kataname+": "+t),e):e},[]).join(",")},St=function(e,t){return"if (this."+e+") out+=this."+e+"(); else {"+t.join(",")+"}\n"},Zt="?",_t={type:"literal",value:"?",description:'"?"'},qt=function(e,t){return"if "+e+"{"+(t.length?"\n":"")+t.join("")+"}\n"},Bt=":",Ut={type:"literal",value:":",description:'":"'},Dt=function(e,t){},Gt=function(e){return"out += ("+e+").replace(/\"/g, '\\\"');"},Ht="!",It={type:"literal",value:"!",description:'"!"'},Jt=function(e){return e},Kt=0,Lt=0,Mt=0,Nt={line:1,column:1,seenCR:!1},Ot=0,Pt=[],Qt=0;if("startRule"in Z){if(!(Z.startRule in q))throw new Error("Can't start parsing from rule \""+Z.startRule+'".');B=q[Z.startRule]}if(S=B(),S!==_&&Kt===e.length)return S;throw S!==_&&Kt<e.length&&r({type:"end",description:"end of input"}),i(null,Pt,Ot)}return e(t,Error),{SyntaxError:t,parse:n}}();