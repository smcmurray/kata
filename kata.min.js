(function(e,r){"use strict";"undefined"!=typeof module?module.exports=r():"function"==typeof define&&"object"==typeof define.amd?define(r()):this[e]=r()})("kata",function(){"use strict";function e(r){var t,n,o=/^\s*\(/g,s=0;if(t=o.exec(r)){for(s+=o.lastIndex,r=r.substr(o.lastIndex),n="(",o=/^((?:(?!«|»).)*?)(\(|\))/g;t=o.exec(r);){if(")"===t[2])return{pos:s+o.lastIndex,value:n+t[0]};n+=t[1],s+=o.lastIndex-1,r=r.substr(o.lastIndex-1),(t=e(r))&&(n+=t.value,s+=t.pos,r=r.substr(t.pos))}throw Error("Parenthetical missing )")}}var r={};return r["%"]=function(r){var t,n,o,s=/^\s*(\w+)/g,i=0;return(t=s.exec(r))&&(n=t[1],i+=s.lastIndex,r=r.substr(s.lastIndex)),(t=e(r))?(o=t.value,i+=t.pos,r=r.substr(t.pos),"»function "+(n?n:"")+o+"{var out='';«"+r+"»}«"):Error("Template block missing arguments")},r["="]=function(e){return"» out += "+e+"; «"},r["@"]=function(r){var t,n,o;if(!(t=e(r)))throw Error("Iterate block missing iterable");if(n=t.value,r=r.substr(t.pos),!(t=e(r)))throw Error("Iterate block missing arguments");return o=t.value,r=r.substr(t.pos),"»"+n+".forEach(function"+o+"{«"+r+"»});«"},r["?"]=function(r){var t,n;if(!(t=e(r)))throw Error("Condition block missing condition");return n=t.value,r=r.substr(t.pos),"»if "+n+"{«"+r+"»}«"},r[":"]=function(r){var t,n;return(t=e(r))&&(n=t.value,r=r.substr(t.pos)),"»} else "+(n?"if "+n:"")+"{«"+r},r["+"]=function(r){var t,n,o,s=/^\s*(\w+)/g;if(!(t=s.exec(r)))throw Error("Import block missing alias");if(n=t.value,r=r.substr(s.lastIndex),!(t=e(r)))throw Error("Import block missing template location");return o=t.value,r=r.substr(t.pos),"»var "+n+" = require"+o+";"},r[">"]=function(r){var t,n,o,s=/^\s*(\w+)/g;if(!(t=s.exec(r)))throw Error("Invoke block missing template name");if(n=t[1],r=r.substr(s.lastIndex),!(t=e(r)))throw Error("Invoke block missing ()");return o=t.value,r=r.substr(t.pos),"»(function(){«"+r+"»out+="+n+o+";}());«"},r["<"]=function(r){var t,n,o,s=/^\s*(\w+)/g;if(!(t=s.exec(r)))throw Error("Yield block missing template name");if(n=t[1],r=r.substr(s.lastIndex),!(t=e(r)))throw Error("Yield block missing ()");return o=t.value,r=r.substr(t.pos),"»if (typeof "+n+' ==="function") out+='+n+o+"; else {«"+r+"»}«"},r["!"]=function(e){return"»"+e+"<<"},function(e,t){var n={src:!1,plugins:{}};t?Object.keys(n).forEach(function(e){t[e]=t.hasOwnProperty(e)?t[e]:n[e]}):t=t||n,r["#"]=function(e){var r,n=/^\w+/;return(r=n.exec(e))?t.plugins[r[0]]?t.plugins[r[0]](e.substr(n.lastIndex)):void 0:e};var o,s,i=/\{\{([%@\?:\+><!#]?)((?:(?!\{\{)[\s\S])*?)([%@\?:\+><!#]?)\}\}/;for(e=e.replace(/\r|\n/g,"\\n");s=i.exec(e);){var u=s[1]||"=",a=s.index,c=a+s[0].length;if(s[3]&&s[3]!=u)throw console.error(e.substring(a-5,c+5)),Error("{{"+s[1]+" at "+(a+2)+" doesn't match "+s[3]+"}} at "+(c-2));try{e=e.substr(0,a)+r[u](s[2])+e.substr(c)}catch(f){throw Error(f+" in "+u+"block between position "+a+" and position "+c)}}return o=e.replace(/«([\s\S]*?)»/g,function(e,r){return"out += '"+r.replace(/\\'/g,"\\$&").replace(/'/g,"\\$&")+"';"}).slice(1,-1),t.src?"(function(name, definition){  'use strict';  if (typeof module != 'undefined') {    module.exports = definition(require);  }  else if (typeof define == 'function' && typeof define.amd == 'object') {    define(definition);  }  else this[name] = definition();}('template', function(require){ return "+o+"}))":Function("return "+o)()}});